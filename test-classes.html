<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>クラス読み込みテスト</title>
</head>
<body>
    <h1>クラス読み込みテスト</h1>
    <div id="results"></div>

    <!-- 共通ユーティリティ -->
    <script src="./src/utils/Constants.js"></script>
    <script src="./src/utils/ErrorHandler.js"></script>

    <!-- サービス層 -->
    <script src="./src/services/StorageService.js"></script>
    <script src="./src/services/NotificationService.js"></script>

    <!-- コア層（基本クラス） -->
    <script src="./src/core/DataStore.js"></script>
    <script src="./src/core/GenerationState.js"></script>

    <!-- UI層 -->
    <script src="./src/ui/TemplateEngine.js"></script>
    <script src="./src/ui/UIRenderer.js"></script>

    <!-- コア層（依存関係のあるクラス） -->
    <script src="./src/core/ContentGenerator.js"></script>
    <script src="./src/core/WizardController.js"></script>
    <script src="./src/core/HubPilotApp.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const results = document.getElementById('results');
            const classes = [
                'Constants',
                'ErrorHandler',
                'StorageService',
                'NotificationService',
                'DataStore',
                'GenerationState',
                'TemplateEngine',
                'UIRenderer',
                'ContentGenerator',
                'WizardController',
                'HubPilotApp'
            ];

            let html = '<h2>クラス読み込み状況:</h2><ul>';

            classes.forEach(className => {
                const isLoaded = typeof window[className] !== 'undefined';
                const status = isLoaded ? '✅ 読み込み済み' : '❌ 読み込み失敗';
                const color = isLoaded ? 'green' : 'red';

                html += `<li style="color: ${color};">${className}: ${status}</li>`;

                if (isLoaded) {
                    try {
                        const instance = new window[className]();
                        console.log(`✅ ${className} インスタンス作成成功:`, instance);
                    } catch (error) {
                        console.error(`❌ ${className} インスタンス作成失敗:`, error);
                        html += `<li style="color: orange; margin-left: 20px;">インスタンス作成エラー: ${error.message}</li>`;
                    }
                }
            });

            html += '</ul>';

            // HubPilotAppの特別テスト
            if (typeof window.HubPilotApp !== 'undefined') {
                html += '<h2>HubPilotApp テスト:</h2>';
                try {
                    console.log('HubPilotApp クラス:', window.HubPilotApp);
                    console.log('HubPilotApp プロトタイプ:', window.HubPilotApp.prototype);

                    // インスタンス作成をテスト
                    const app = new window.HubPilotApp();
                    html += '<p style="color: green;">✅ HubPilotApp インスタンス作成成功</p>';
                    console.log('✅ HubPilotApp インスタンス:', app);
                } catch (error) {
                    html += `<p style="color: red;">❌ HubPilotApp インスタンス作成失敗: ${error.message}</p>`;
                    console.error('❌ HubPilotApp エラー:', error);
                    console.error('❌ エラースタック:', error.stack);
                }
            }

            results.innerHTML = html;
        });
    </script>
</body>
</html>
