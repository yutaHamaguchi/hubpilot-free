# 要件定義書

## はじめに

本ドキュメントは、HubSpotのブログ戦略をトピッククラスターモデルで自動化するSEO記事作成エージェントアプリケーションの要件を定義します。システムはピラーページとクラスターページを構造化されたアプローチで生成し、AI画像生成、WordPress統合、ユーザーンターフェース包括的なコンテンツ作成ワークフローを提供します。

## 用語集

- **トピッククラスターモデル**: 1つのピラーページが広範なトピックをカバーし、複数のクラスターページが関連するサブトピックをカバーし、すべて内部リンクで相互接続されたコンテンツ戦略
- **ピラーページ**: 中核となるトピックを包括的にカバーし、中央ハブとして機能する総合的なページ
- **クラスターページ**: ピラーページに関連する特定のサブトピックをカバーする詳細ページ
- **ウィザードインターフェース**: ユーザーを多段階プロセスを通じてガイドするステップバイステップのユーザーインターフェース
- **AI記事生成器**: DeepSeek/OpenAI APIを使用して記事コンテンツを作成するシステムコンポーネント
- **AI画像生成器**: DALL-E 3/Stability AIを使用して記事画像を生成するシステムコンポーネント
- **品質チェッカー**: 生成されたコンテンツの品質を検証するシステムコンポーネント
- **WordPress統合**: WordPress REST APIを使用した記事投稿機能
- **認証システム**: Supabase Authを使用したユーザー管理機能
- **クラウドストレージ**: Supabaseを使用したデータ永続化とリアルタイム同期

## 要件

### 要件1: テーマ入力と設定

**ユーザーストーリー:** コンテンツマーケターとして、コンテンツ戦略のメインテーマを入力したいので、選択した主題を中心とした構造化されたトピッククラスターを生成できます。

#### 受入基準

1. ユーザーがアプリケーションにアクセスしたとき、システムは認証画面またはゲストモードの選択を表示する必要があります
2. ユーザーが認証またはゲストモードを選択したとき、ウィザードインターフェースは最初のステップとしてテーマ入力画面を表示する必要があります
3. ユーザーが入力フィールドにメインテーマを入力したとき、システムは入力が空でないことを検証する必要があります
4. ユーザーが有効な入力で「構成案を作成」ボタンをクリックしたとき、システムは構造生成ステップに進む必要があります
5. テーマ入力画面はインターフェースの中央に大きく目立つ入力フィールドを表示する必要があります

### 要件2: コンテンツ構造生成

**ユーザーストーリー:** コンテンツストラテジストとして、システムにピラーページタイトルとクラスターページタイトルを自動生成してもらいたいので、包括的なコンテンツ構造を迅速に確立できます。

#### 受入基準

1. システムがテーマを処理するとき、AI記事生成器は正確に1つのピラーページタイトルを作成する必要があります
2. システムがテーマを処理するとき、AI記事生成器は正確に10個のクラスターページタイトルを作成する必要があります
3. AI APIが利用できない場合、システムはモック生成にフォールバックする必要があります
4. 構造生成が完了したとき、システムはピラーページタイトルを上部に目立つように表示する必要があります
5. 構造生成が完了したとき、システムはすべてのクラスターページタイトルを編集可能なリストで表示する必要があります
6. システムはユーザーが個別のクラスターページタイトルを編集できるようにする必要があります
7. システムはユーザーがリストからクラスターページタイトルを削除または追加できるようにする必要があります

### 要件3: 見出し構造作成

**ユーザーストーリー:** コンテンツクリエイターとして、システムに各クラスターページのH2見出しを生成してもらいたいので、コンテンツ生成前に記事構造をレビューし改良できます。

#### 受入基準

1. システムが見出し生成を開始するとき、各クラスターページに対して3-6個のH2見出しを生成する必要があります
2. AI APIが利用できない場合、システムはモック見出し生成にフォールバックする必要があります
3. 見出し生成が完了したとき、システムは各ページの見出しを編集可能な形式で表示する必要があります
4. システムはユーザーが見出しテキストを編集できるようにする必要があります
5. システムはユーザーが見出しを追加または削除できるようにする必要があります
6. システムはユーザーが見出しレベル（H2/H3）を変更できるようにする必要があります

### 要件4: AI記事生成

**ユーザーストーリー:** コンテンツライターとして、システムに高品質な記事コンテンツを自動生成してもらいたいので、手動執筆時間を大幅に短縮できます。

#### 受入基準

1. システムが記事生成を開始するとき、各クラスターページに対して1800-2200文字の記事を生成する必要があります
2. 記事生成中、システムはリアルタイムの進捗表示を提供する必要があります
3. システムはDeepSeek APIを主要な生成エンジンとして使用し、失敗時にOpenAI APIにフォールバックする必要があります
4. AI APIが利用できない場合、システムはモック記事生成を提供する必要があります
5. ユーザーは記事生成を一時停止、再開、キャンセルできる必要があります
6. 生成された記事は見出し構造に基づいて適切に構造化される必要があります
7. システムは生成された各記事の文字数とステータスを表示する必要があります

### 要件5: AI画像生成

**ユーザーストーリー:** コンテンツマーケターとして、記事に関連する高品質な画像を自動生成してもらいたいので、視覚的に魅力的なコンテンツを作成できます。

#### 受入基準

1. システムが画像生成を開始するとき、各記事に対してヒーロー画像を1枚生成する必要があります
2. システムが画像生成を開始するとき、各記事に対して説明画像を2-3枚生成する必要があります
3. システムはDALL-E 3 APIを主要な画像生成エンジンとして使用し、失敗時にStability AIにフォールバックする必要があります
4. 画像生成プロンプトは記事内容に基づいて自動的に最適化される必要があります
5. 生成された画像はSupabase Storageに保存される必要があります
6. システムは生成された画像のプレビューとダウンロード機能を提供する必要があります
7. 画像は記事のMarkdownに自動的に挿入される必要があります

### 要件6: 品質チェック

**ユーザーストーリー:** コンテンツマネージャーとして、生成されたコンテンツの品質を自動評価してもらいたいので、公開前に品質基準を満たしていることを確認できます。

#### 受入基準

1. システムが品質チェックを実行するとき、各記事の文字数、SEO最適化、可読性、構造の4項目をチェックする必要があります
2. AI APIが利用できる場合、システムは詳細なSEO分析と改善提案を提供する必要があります
3. 品質チェック結果は視覚的にわかりやすいスコアとステータスで表示される必要があります
4. システムは品質チェック結果に基づいて改善提案を提供する必要があります
5. 品質チェックは記事生成完了後に自動的に実行される必要があります

### 要件7: ユーザー認証とデータ管理

**ユーザーストーリー:** ユーザーとして、アカウントを作成してログインしたいので、プロジェクトデータを安全に保存し、複数デバイス間で同期できます。

#### 受入基準

1. システムはメールアドレスとパスワードによるユーザー登録機能を提供する必要があります
2. システムはGoogle、GitHubによるソーシャルログイン機能を提供する必要があります
3. システムはゲストモードでの利用を許可し、データはローカルストレージに保存される必要があります
4. 認証されたユーザーのデータはSupabaseクラウドに保存される必要があります
5. システムはパスワードリセット機能を提供する必要があります
6. ユーザーはプロファイル情報（表示名、アバター）を更新できる必要があります
7. システムは複数デバイス間でのリアルタイムデータ同期を提供する必要があります

### 要件8: WordPress統合

**ユーザーストーリー:** ブログ管理者として、生成された記事を直接WordPressサイトに投稿したいので、手動でのコピー&ペースト作業を省略できます。

#### 受入基準

1. システムはWordPress REST API接続設定機能を提供する必要があります
2. システムはWordPress接続テスト機能を提供する必要があります
3. ユーザーは記事を下書き、公開、レビュー待ちのステータスで投稿できる必要があります
4. システムは複数記事の一括投稿機能を提供する必要があります
5. システムはWordPressカテゴリーの選択機能を提供する必要があります
6. 生成された画像もWordPressメディアライブラリにアップロードされる必要があります
7. システは投稿結果（成功/失敗）を詳細に表示する必要があります

### 要件9: 最終承認とエクスポート

**ユーザーストーリー:** プロジェクトマネージャーとして、完成したコンテンツ戦略をレビューし、様々な形式でエクスポートしたいので、チームメンバーと共有し、様々なプラットフォームで活用できます。

#### 受入基準

1. システムはピラーページの統合プレビューを表示する必要があります
2. システムはプロジェクト統計（総記事数、総文字数、画像数）を表示する必要があります
3. システムはプロジェクトデータをJSON形式でエクスポートする機能を提供する必要があります
4. システムは記事をMarkdown形式でエクスポートする機能を提供する必要があります
5. システムは記事をHTML形式でエクスポートする機能を提供する必要があります
6. システムは生成された画像を含む完全なプロジェクトパッケージをダウンロードする機能を提供する必要があります

### 要件10: システム管理と監視

**ユーザーストーリー:** システム管理者として、アプリケーションの健全性とパフォーマンスを監視したいので、問題を早期に発見し、ユーザーエクスペリエンスを最適化できます。

#### 受入基準

1. システムは包括的なエラーハンドリングとユーザーフレンドリーなエラーメッセージを提供する必要があります
2. システムは開発者向けデバッグコマンドとヘルスチェック機能を提供する必要があります
3. システムは自動保存機能（30秒間隔）を提供する必要があります
4. システムは自動バックアップ機能（最新5件）を提供する必要があります
5. システムはオフライン/オンライン状態の検出と適切な処理を提供する必要があります
6. システムはパフォーマンス監視とメトリクス収集機能を提供する必要があります
7. システムはAPI使用量とコスト追跡機能を提供する必要があります
